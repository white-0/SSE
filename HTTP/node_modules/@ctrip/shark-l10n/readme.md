# shark-l10n

用于前端的shark本地化组件包

## 引入组件

### 使用NPM包

```shell
npm i @ctrip/shark-l10n
```

#### 目标文件

目标文件无需再次打包,可以直接通过script标签引入,也支持以umd方式加载

```javascript
// 内嵌dayjs
import l10n from '@ctrip/shark-l10n/dist/components/l10n'
```

#### 原始文件

原始文件需要二次打包,但无需配置babel

**全量引入**

```javascript
import { L10n } from '@ctrip/shark-l10n'
```

**按需引入**

```javascript
// 时间日期格式化组件
import { DateTimeFormatter } from '@ctrip/shark-l10n/lib/datetime'

// 时长格式化组件
import { DurationFormatter } from '@ctrip/shark-l10n/lib/duration'

// 度量衡组件
import { MeasurementFormatter } from '@ctrip/shark-l10n/lib/measurement'

// 姓名格式化组件
import { NameFormatter } from '@ctrip/shark-l10n/lib/name'

// 数字/货币本地化组件
import { NumberFormatter } from '@ctrip/shark-l10n/lib/number'

// 手机号码本地化组件
import { PhoneFormatter } from '@ctrip/shark-l10n/lib/phone'

// 单复数组件
import { getPlural } from '@ctrip/shark-l10n/lib/plural'

// 常量枚举: 进位规则,单位制,度量衡单位
import { ROUNDING_MODE, UnitCollection, Unit, CredentialType } from '@ctrip/shark-l10n/lib/types'
```

## 引入数据源

### 日期/时长/数字/度量衡

依赖shark 6002的多语言包,需要作为依赖传入至相关组件的I18n参数中

多语言包获取方式请参考shark-js-sdk: http://conf.ctripcorp.com/x/VK3-Ug
文档：http://conf.ctripcorp.com/x/d63-Ug

### 单复数

依赖用户当前应用的多语言包,在调用相关方法时需要作为参数传入

## API Reference

### L10n合成包

```typescript
export declare class L10n {
    constructor(i18n: II18n);
    setI18n(i18n: II18n): L10n;
    DateTimeFormat(timezone?: Timezone): DateTimeFormatter;
    DurationFormat(locale: string): DurationFormatter;
    MeasurementFormat(): MeasurementFormatter;
    NameFormat(): NameFormatter;
    NumberFormat(): NumberFormatter;
    PhoneFormat(): PhoneFormatter;
    getPlural(key: string, locale: string, num: string | number): string;
}
```

### 时间日期本地化: DateTimeFormatter

参考文档: http://conf.ctripcorp.com/pages/viewpage.action?pageId=144708675

```typescript
export declare type Timestamp = number | string | Date;

export declare type Timezone = -12 | -11 | -10 | -9 | -8 | -7 | -6 | -5 | -4 | -3 | -2 | -1 | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12;

export declare class DateTimeFormatter {
    constructor(i18n: II18n, timezone?: Timezone);
    mdShortString(timestamp: Timestamp): string;
    mdFullString(timestamp: Timestamp): string;
    mdCalendarString(timestamp: Timestamp): string;
    mdeFullString(timestamp: Timestamp): string;
    mdeShortString(timestamp: Timestamp): string;
    mdhmFullString(timestamp: Timestamp): string;
    mdhmShortString(timestamp: Timestamp): string;
    mdhmsFullString(timestamp: Timestamp): string;
    mdhmsShortString(timestamp: Timestamp): string;
    ymCalendarString(timestamp: Timestamp): string;
    ymFullString(timestamp: Timestamp): string;
    ymShortString(timestamp: Timestamp): string;
    ymdFullString(timestamp: Timestamp): string;
    ymdShortString(timestamp: Timestamp): string;
    ymdhmFullString(timestamp: Timestamp): string;
    ymdhmShortString(timestamp: Timestamp): string;
    ymdhmsFullString(timestamp: Timestamp): string;
    ymdhmsShortString(timestamp: Timestamp): string;
    ymdeFullString(timestamp: Timestamp): string;
    ymdeShortString(timestamp: Timestamp): string;
    ymdhmeFullString(timestamp: Timestamp): string;
    ymdhmeShortString(timestamp: Timestamp): string;
    ymdhmseFullString(timestamp: Timestamp): string;
    ymdhmseShortString(timestamp: Timestamp): string;
    hmeShortString(timestamp: Timestamp): string;
    hmeFullString(timestamp: Timestamp): string;
    hmseShortString(timestamp: Timestamp): string;
    hmseFullString(timestamp: Timestamp): string;
    eFullString(timestamp: Timestamp): string;
    eShortString(timestamp: Timestamp): string;
    mFullString(timestamp: Timestamp): string;
    mShortString(timestamp: Timestamp): string;
    hmString(timestamp: Timestamp): string;
    hmsString(timestamp: Timestamp): string;
    yString(timestamp: Timestamp): string;
    mdhmeShortString(timestamp: Timestamp): string;
    mdhmeFullString(timestamp: Timestamp): string;
    dFullString(timestamp: Timestamp): string;
    dShortString(timestamp: Timestamp): string;
}
```

### 时长格式化模块: DurationFormatter

参考文档: http://conf.ctripcorp.com/pages/viewpage.action?pageId=144708675#id-%E3%80%90Localization%E3%80%91%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4%E5%B1%95%E7%A4%BA-%E6%97%B6%E9%95%BF%E5%B1%95%E7%A4%BA:

```typescript
export declare class DurationFormatter {
    constructor(i18n: II18n, locale?: string);
    convertToString(duration: number, pattern: string, isAutoAbbr?: boolean, isFullName?: boolean): string;
}
```

### 度量衡模块: MeasurementFormatter

参考文档: http://conf.ctripcorp.com/pages/viewpage.action?pageId=145940891

```typescript
export declare enum Unit {
    Kilometer = "Kilometer",
    Mile = "Mile",
    SquareMeter = "SquareMeter",
    SquareFeet = "SquareFeet",
    Celsius = "Celsius",
    Fahrenheit = "Fahrenheit",
    Meter = "Meter",
    Feet = "Feet",
    Kilogram = "Kilogram",
    Pound = "Pound",
    Centimeter = "Centimeter",
    Inch = "Inch"
}

export declare enum UnitCollection {
    MetricUnit = "MetricUnit",
    ImperialUnit = "ImperialUnit"
}

export declare class MeasurementFormatter {
    constructor(i18n: II18n);
    formatString(value: number, fromType: Unit, toType: Unit, useGrouping?: boolean, minimumFractionDigits?: number, maximumFractionDigits?: number, extendOption?: Partial<{
      roundingMode?: ROUNDING_MODE,
      trimRedundantZero?: boolean,
    }): string;
    convert(value: number, fromType: Unit, toType: Unit, useGrouping?: boolean, minimumFractionDigits?: number, maximumFractionDigits?: number, extendOption?: Partial<{
      roundingMode?: ROUNDING_MODE,
      trimRedundantZero?: boolean,
    }): string;
    convertToPreferences(value: number, fromType: Unit, preferencesUnit?: UnitCollection, useGrouping?: boolean, minimumFractionDigits?: number, maximumFractionDigits?: number, extendOption?: Partial<{
      roundingMode?: ROUNDING_MODE,
      trimRedundantZero?: boolean,
    }): string;
}
```

### 姓名格式化模块: NameFormatter

参考文档: http://conf.ctripcorp.com/pages/viewpage.action?pageId=248088102

```typescript
export declare enum CredentialType {
    IDCardCredentialType = 'IDCard',
    PassportCredentialType = 'Passport',
    DrivingCardCredentialType = 'DrivingCard',
    HomeReturnPermitCredentialType  = 'HRP',
    MTPCredentialType = 'MTP',
    UsualCredentialType = 'Usual',
    UsualNoMidNameCredentialType = 'UsualNoMidName'
}

export declare type INameModel = {
    type: string;
    title: string;
    sample: string;
    sampleForEn: string;
};

export declare class NameFormatter {
    constructor(i18n: II18n);
    nameTypesWithCredentialType(credentialType: CredentialType): INameModel [];
}

```

### 数字/币种格式化模块: NumberFormatter

参考文档:

* http://conf.ctripcorp.com/pages/viewpage.action?pageId=145941322

* http://conf.ctripcorp.com/pages/viewpage.action?pageId=164299403

```typescript
export declare enum ROUNDING_MODE {
    DOWN = 0,
    HALF_UP = 1,
    HALF_EVEN = 2,
    UP = 3
}

export declare class NumberFormatter {
    constructor(i18n: II18n);
    decimalString(decimalNum: string | number, useGrouping?: boolean, minimumFractionDigits?: number, maximumFractionDigits?: number, extendOption?: Partial<{
        showPercentage: boolean,
        roundingMode: ROUNDING_MODE,
        numberFormatCustomized: string,
        trimRedundantZero: boolean,
    }>): string;

    shortDecimalString (decimalNum: string | number, useGrouping?: boolean, minimumFractionDigits?: number, maximumFractionDigits?: number, extendOption?: Partial<{
      showPercentage: boolean,
      roundingMode: ROUNDING_MODE,
      numberFormatCustomized: string,
      trimRedundantZero: boolean,
    }>): string;

    currencyString(decimalNum: string | number, currency?: string, useGrouping?: boolean, minimumFractionDigits?: number, maximumFractionDigits?: number, extendOption?: Partial<{
        roundingMode: ROUNDING_MODE,
        currencyFormatCustomized: string,
        numberFormatCustomized: string,
    }>): string;

    specialCurrencyString(decimalNum: string | number, currency?: string, useGrouping?: boolean, minimumFractionDigits?: number, maximumFractionDigits?: number, extendOption?: Partial<{
        roundingMode: ROUNDING_MODE,
        currencyFormatCustomized: string,
        numberFormatCustomized: string,
    }>): string;
}
```

### 手机号码格式化模块: PhoneFormatter

参考文档: http://conf.ctripcorp.com/pages/viewpage.action?pageId=1683462216

```typescript
export declare class PhoneFormatter {
  constructor(i18n: II18n);
  validatePhoneNumber (regionCode: string | number, phoneNumber: string | number): boolean;
}
```

### 单复数模块: Plural

参考文档:

* http://conf.ctripcorp.com/pages/viewpage.action?pageId=147190108

* http://conf.ctripcorp.com/pages/viewpage.action?pageId=147191144

```typescript
export declare function getPlural(
    i18n: II18n,
    key: string,
    locale: string,
    num: string | number
): string;
```

### dist/生产包

#### l10n

```javascript
var l10n = {

  l10n: window.i18n_6002 || {},

  DateTimeFormat: function (timezone) {
    return instance.setI18n(l10n.l10n).DateTimeFormat(timezone)
  },

  DurationFormat: function (locale) {
    return instance.setI18n(l10n.l10n).DurationFormat(locale)
  },

  MeasurementFormat: function () {
    return instance.setI18n(l10n.l10n).MeasurementFormat()
  },

  NameFormat: function () {
    return instance.setI18n(l10n.l10n).NameFormat()
  },

  NumberFormat: function () {
    return instance.setI18n(l10n.l10n).NumberFormat()
  },

  PhoneFormat: function () {
    return instance.setI18n(l10n.l10n).PhoneFormat()
  },

  getPlural: function (i18n, key, locale, num) {
    return instance.setI18n(i18n).getPlural(key, locale, num);
  },

  ROUNDING_MODE: ROUNDING_MODE,

  Unit: Unit,

  UnitCollection: UnitCollection,

  CredentialType: CredentialType,
}
```

`注意事项`: 如果i18n_6002在l10n之后引入,需要手动进行赋值,否则会格式化失败

```javascript
l10n.l10n = window.i18n_6002
```
