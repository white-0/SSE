'use strict'
const assert = require('assert')
const cargo = require('../index')
const browser = require('../browser')

describe('cargo test', () => {

  it('test for cargo initialization', done => {
    cargo.init({
      logLevel: cargo.LOG_LEVEL.NONE
    }).then(() => {
      done()
    })
  })

  describe('test for constants', () => {
    assert.equal(cargo.LOG_LEVEL, require('../lib/log/log-level'))
    assert.equal(cargo.DATA_TYPE, require('../lib/common/data-type'))
    assert.equal(cargo.CONTEXT_TYPE, require('../lib/context/context-config').CONTEXT_TYPE)
    assert.equal(cargo.middlewares, require('../lib/middlewares'))
  })

  describe('helper test', () => {
    require('./helper.test')
  })

  describe('heartbeat collector test', () => {
    require('./heartbeat.test')
  })

  describe('version manager test', () => {
    require('./version-manager.test')
  })

  describe('cache test', () => {
    require('./cache.test')(cargo)
  })

  describe('query test', () => {
    require('./query.test')(cargo)
  })

  describe('online context test', () => {
    require('./context.test')(cargo)
  })

  describe('h5 context test', () => {
    require('./context-h5.test')(cargo)
  })

  describe('context query test', () => {
    require('./context-query.test')(cargo)
  })

  describe('browser context test', () => {
    require('./browser.test')(browser)
  })
})
