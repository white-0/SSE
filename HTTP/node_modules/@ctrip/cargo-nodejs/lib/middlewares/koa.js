'use strict'
const cargo = require('../cargo')

module.exports = contextType => (ctx, next) => {
  return new Promise((resolve, reject) => {
    const cargoContext = cargo.getCargoContext(ctx.req, ctx.res, contextType)
    cargoContext.setBrowserCookies()
    ctx.cargoContext = cargoContext
    ctx.req.cargoContext = ctx.req.cargo = cargoContext // 兼容旧代码
    resolve(next())
  })
}
