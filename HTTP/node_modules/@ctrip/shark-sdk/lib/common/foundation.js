'use strict'
const foundationFramework = require('@ctrip/node-vampire-foundation-framework')
const LOG_LEVEL = require('../log/log-level')

function isPROD (env) {
  return ['pro', 'prod', 'prd'].includes((env || '').toLowerCase())
}

class SharkFoundation {
  constructor () {
    /**
     * 当前应用id
     */
    this.appID = parseInt(foundationFramework.getAppID())

    /**
     * 当前环境
     */
    this.env = (foundationFramework.getServerPropertiesSync('env') || '').toLowerCase()
    this.isPROD = isPROD(this.env)
    this.idc = 'SHA'

    /**
     * client ip
     */
    this.clientIp = foundationFramework.getHostIP()

    /**
     * 默认日志等级
     */
    this.logLevel = this.isPROD ? LOG_LEVEL.WARNING : LOG_LEVEL.INFO

    /**
     * 当前点火状态
     */
    this.ignited = false

    /**
     * file locker
     */
    this.fileLocker = null
  }
}

module.exports = new SharkFoundation()
